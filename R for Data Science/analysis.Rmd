---
title: Gapminder analysis
author: Ben Yang
output: html_document
---

# Guided section

```{r results='hide', message=F}
library(tidyverse)
```

## 1. Read data

```{r results='hide', message=F, warning=F}
data <- read_csv('./gapminder_clean.csv')
data <- data %>%
    select(-1) %>%
    rename(co2Em = `CO2 emissions (metric tons per capita)`)
```

## 2. Scatterplot of CO2 emissions and GDP in 1962

```{r}
data1962 <- data %>%
    filter(Year == 1962) %>%
    select(gdpPercap, co2Em) %>%
    drop_na()
ggplot(data = data1962) +
    geom_point(mapping = aes(
        x = gdpPercap,
        y = co2Em)) +
    labs(x = "GDP per capita", y = "CO2 emissions per capita (metric tons)")
```

## 3. Pearson correlation of CO2 emissions and GDP

```{r}
cor.test(data1962 %>% pull(gdpPercap), data1962 %>% pull(co2Em))
```

## 4. Year of strongest correlation between CO2 emissions and GDP

```{r}
corrs <- data %>%
    group_by(Year) %>%
    select(Year, gdpPercap, co2Em) %>%
    drop_na() %>%
    summarise(corrleation = cor(gdpPercap, co2Em))
lapply(corrs, max)
```


# Open section

TODO
